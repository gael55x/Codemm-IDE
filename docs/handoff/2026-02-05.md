# Handoff: 2026-02-05

## Summary (Current State)

- Backend SQLite storage is now routed to a user-writable data directory by default.
- The Electron wrapper now:
  - ensures `userData`/cache/logs directories exist
  - starts the backend with `CODEMM_DB_PATH=<userData>/codem.db`

## How To Run (Current)

From repo root:

```bash
npm install
npm run dev
```

## Iteration Log

### Iteration 1 (SQLite + Electron Storage Path Hardening)

Commit(s): N/A (local changes)

- Backend DB path selection:
  - loads `.env` early so `CODEMM_DB_PATH` works reliably
  - defaults to an OS-appropriate per-user data dir (instead of repo-local `apps/backend/data/`)
- IDE/Backend legacy DB migration:
  - if `CODEMM_DB_PATH` is not explicitly set and `<userData>/codem.db` does not exist yet, the IDE copies `apps/backend/data/codem.db` once into `<userData>/codem.db`
- IDE wrapper:
  - creates/sets Electron `userData` + cache/logs dirs (reduces Chromium “temp index file” errors)
  - passes `CODEMM_DB_PATH` to the backend to keep DB out of repo folders by default

## Known Gaps / Risks (Current)

- Still dev-mode (`npm run dev` starts `nodemon` + `next dev`).
- Packaging into a distributable `.app` is still pending (native deps like `better-sqlite3` will need Electron rebuilds).
